<%= form_with model: change_record do |f| %>
  <% if change_record.errors.any? %>
    <div class="errors">
      <h2><%= pluralize(change_record.errors.count, "error") %>
        prohibited this change from being saved</h2>
      <ul>
        <% change_record.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
  <%= render FormFieldsetComponent.new(legend: "Change information") do %>
    <%= render FormFieldComponent.new(form: f, label: "Name: ", field: :name) %>
    <%= render FormFieldComponent.new(
      form: f,
      type: :select,
      options: ChangeType.all,
      label: "Change Type: ",
      field: :change_type_id,
    ) %>

    <%= render FormFieldComponent.new(
      form: f,
      type: :textarea,
      label: "Description: ",
      field: :description,
    ) %>
    <%= render FormFieldComponent.new(
      form: f,
      type: :textarea,
      label: "Business Justification: ",
      field: :business_justification,
    ) %>
  <% end %>
  <%= render FormFieldsetComponent.new(legend: "Implementation information") do %>

    <%= render FormFieldComponent.new(
      form: f,
      type: :textarea,
      label: "Implementation Plan: ",
      field: :implementation_plan,
    ) %>
    <%= render FormFieldComponent.new(
      form: f,
      type: :textarea,
      label: "Test Plan: ",
      field: :test_plan,
    ) %>
    <%= render FormFieldComponent.new(
      form: f,
      type: :textarea,
      label: "Rollback Plan: ",
      field: :rollback_plan,
    ) %>
  <% end %>
  <%= render FormFieldComponent.new(
    form: f,
    type: :textarea,
    label: "Risks: ",
    field: :risks,
  ) %>
  <%= render FormFieldComponent.new(
    form: f,
    type: :select,
    options: Risk.all,
    label: "Overall Risk Level: ",
    field: :risk_id,
  ) %>
  <div class="actions" mt-4>
    <%= f.submit class: "btn btn-primary ml-4" %>
  </div>
<% end %>
